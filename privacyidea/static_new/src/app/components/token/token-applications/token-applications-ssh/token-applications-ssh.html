<div aria-label="Token Applications SSH"
     class="token-applications-ssh">
  <div class="details-flex-layout flex-column">
    <div class="application-p-div">
      <p>SSH Tokens can be attached to a service ID with a user. The user is the user on the SSH
        server and may differ from the token owner. To attach the token to a service ID go to the
        token details. </p>
      <p>To define service IDs go to <a ui-sref="config.serviceid">Service ID config</a>. </p>
    </div>
  </div>
  <div class="application-table-container">
    <div class="filter-paginator-container">
      <mat-form-field class="application-table-filter"
                      subscriptSizing="dynamic">
        <mat-label>Enter Filter</mat-label>
        <input #filterInput
               (keyup)="onFilterChange(filterInput.value)"
               aria-label="Filter Input"
               matInput
               placeholder="Example query: 'service_id: myService'" />
      </mat-form-field>
      <mat-paginator (page)="tableUtilsService.handlePageEvent(
                           $event, pageIndex, pageSize, fetchApplicationSshData)"
                     [length]="length()"
                     [pageIndex]="pageIndex()"
                     [pageSizeOptions]="pageSizeOptions"
                     [pageSize]="pageSize()"
                     showFirstLastButtons></mat-paginator>
    </div>
    <app-keyword-filter [advancedApiFilter]="advancedApiFilter"
                        [apiFilter]="apiFilter"
                        [clickedKeyword]="clickedKeyword"
                        [filterInput]="filterInput"
                        [filterValue]="filterValue"></app-keyword-filter>
    <table (matSortChange)="tableUtilsService.handleSortEvent($event, pageIndex, sortby_sortdir,
  fetchApplicationSshData)"
           [dataSource]="dataSource()"
           [matSortDisableClear]="false"
           aria-label="Token Applications Table"
           class="token-table"
           mat-table
           matSort>
      @for (column of columnsKeyMap; track column) {
        <ng-container [matColumnDef]="column.key">
          <th *matHeaderCellDef
              attr.aria-label="{{ column.label }} Header"
              mat-header-cell
              mat-sort-header>
            {{ column.label }}
          </th>
          <td *matCellDef="let element"
              attr.aria-label="{{ column.label }} Cell"
              mat-cell
              [ngClass]="{ 'width-18rem': column.key === 'description' }">
            <div [ngClass]="tableUtilsService.getClassForColumnKey(column.key)">
              @switch (column.key) {
                @case ("serial") {
                  <a attr.aria-label="{{ column.label }} Link"
                     (click)="tokenSelected(element.serial)"> {{ element[column.key] }} </a>
                  <app-copy-button [copyText]="element.serial"></app-copy-button>
                }
                @default {
                  @if (tableUtilsService.isLink(column.key)) {
                    <a attr.aria-label="{{ column.label }} Link"
                       href="#"> {{ element[column.key] }} </a>
                  } @else {
                    <span [ngClass]="tableUtilsService.getClassForColumn(column.key, element)">
                  {{ tableUtilsService.getDisplayText(column.key, element) }}
                </span>
                  }
                }
              }
            </div>
          </td>
        </ng-container>
      }
      <tr *matHeaderRowDef="displayedColumns"
          aria-label="Header Row"
          mat-header-row></tr>
      <tr *matRowDef="let row; columns: displayedColumns"
          aria-label="Data Row"
          mat-row></tr>
      <tr *matNoDataRow
          aria-label="No Data Row">
        <td [attr.colspan]="displayedColumns.length"
            aria-label="No Data Cell">
          No data matching the filter.
        </td>
      </tr>
    </table>
  </div>
</div>
